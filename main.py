players = [
    {"name": "Lionel Messi", "team": "Paris Saint-Germain", "goals": 27, "assists": 18},
    {"name": "Cristiano Ronaldo", "team": "Al Nassr", "goals": 30, "assists": 5},
    {"name": "Kylian Mbappé", "team": "Paris Saint-Germain", "goals": 25, "assists": 7},
    {"name": "Neymar Jr", "team": "Paris Saint-Germain", "goals": 15, "assists": 12},
    {"name": "Mohamed Salah", "team": "Liverpool", "goals": 23, "assists": 10},
    {"name": "Erling Haaland", "team": "Manchester City", "goals": 35, "assists": 4},
    {"name": "Robert Lewandowski", "team": "Barcelona", "goals": 27, "assists": 6},
    {"name": "Harry Kane", "team": "Bayern Munich", "goals": 28, "assists": 5},
    {"name": "Kevin De Bruyne", "team": "Manchester City", "goals": 6, "assists": 16},
    {"name": "Luka Modrić", "team": "Real Madrid", "goals": 5, "assists": 7},
    {"name": "Vinícius Júnior", "team": "Real Madrid", "goals": 21, "assists": 10},
    {"name": "Karim Benzema", "team": "Al-Ittihad", "goals": 18, "assists": 7},
    {"name": "Sadio Mané", "team": "Al Nassr", "goals": 16, "assists": 8},
    {"name": "Thibaut Courtois", "team": "Real Madrid", "goals": 0, "assists": 0},
    {"name": "Jan Oblak", "team": "Atletico Madrid", "goals": 0, "assists": 0},
    {"name": "Marc-André ter Stegen", "team": "Barcelona", "goals": 0, "assists": 0},
    {"name": "Gianluigi Donnarumma", "team": "Paris Saint-Germain", "goals": 0, "assists": 0},
    {"name": "Alisson Becker", "team": "Liverpool", "goals": 1, "assists": 0},
    {"name": "Trent Alexander-Arnold", "team": "Liverpool", "goals": 5, "assists": 15},
    {"name": "Virgil van Dijk", "team": "Liverpool", "goals": 8, "assists": 2},
    {"name": "Ruben Dias", "team": "Manchester City", "goals": 4, "assists": 1},
    {"name": "Mohamed Elneny", "team": "Arsenal", "goals": 2, "assists": 4},
    {"name": "Gonzalo Higuaín", "team": "Retired", "goals": 35, "assists": 15},
    {"name": "Marcelo", "team": "Fluminense", "goals": 7, "assists": 8},
    {"name": "João Félix", "team": "Chelsea", "goals": 10, "assists": 6},
    {"name": "Vinícius Júnior", "team": "Real Madrid", "goals": 21, "assists": 10},
    {"name": "Sergio Ramos", "team": "Paris Saint-Germain", "goals": 7, "assists": 3},
    {"name": "David Silva", "team": "Real Sociedad", "goals": 3, "assists": 7},
    {"name": "Zlatan Ibrahimović", "team": "Retired", "goals": 500, "assists": 200},
    {"name": "Marco Reus", "team": "Borussia Dortmund", "goals": 10, "assists": 8},
    {"name": "Jadon Sancho", "team": "Manchester United", "goals": 9, "assists": 5},
    {"name": "Paulo Dybala", "team": "AS Roma", "goals": 15, "assists": 9},
    {"name": "Angel Di María", "team": "Benfica", "goals": 6, "assists": 10},
    {"name": "Jack Harrison", "team": "Leeds United", "goals": 8, "assists": 7},
    {"name": "Declan Rice", "team": "Arsenal", "goals": 6, "assists": 5},
    {"name": "Timo Werner", "team": "RB Leipzig", "goals": 14, "assists": 5},
    {"name": "Christian Pulisic", "team": "Chelsea", "goals": 6, "assists": 8},
    {"name": "Giovani Lo Celso", "team": "Villarreal", "goals": 5, "assists": 6},
    {"name": "Ciro Immobile", "team": "Lazio", "goals": 20, "assists": 5},
    {"name": "Dries Mertens", "team": "Galatasaray", "goals": 13, "assists": 9},
    {"name": "Mauro Icardi", "team": "Galatasaray", "goals": 22, "assists": 7},
    {"name": "Hugo Lloris", "team": "Tottenham Hotspur", "goals": 0, "assists": 0},
    {"name": "Pierre-Emerick Aubameyang", "team": "Chelsea", "goals": 11, "assists": 5},
    {"name": "Eden Hazard", "team": "Real Madrid", "goals": 7, "assists": 6},
    {"name": "Gareth Bale", "team": "Retired", "goals": 50, "assists": 30},
    {"name": "Nicolas Pépé", "team": "Arsenal", "goals": 12, "assists": 6},
    {"name": "James Rodríguez", "team": "Al Rayyan", "goals": 6, "assists": 7},
    {"name": "Luis Suárez", "team": "Grêmio", "goals": 12, "assists": 4},
    {"name": "André Onana", "team": "Manchester United", "goals": 0, "assists": 0}
]

employees = [
    {"name": "Alice", "position": "Software Engineer", "salary": 90000, "age": 28},
    {"name": "Bob", "position": "Data Scientist", "salary": 95000, "age": 32},
    {"name": "Charlie", "position": "Product Manager", "salary": 105000, "age": 35},
    {"name": "David", "position": "Software Engineer", "salary": 85000, "age": 25},
    {"name": "Eve", "position": "UX Designer", "salary": 70000, "age": 30},
    {"name": "Frank", "position": "Software Engineer", "salary": 92000, "age": 29},
    {"name": "Fras", "position": "Software Engineer", "salary": 90000, "age": 29},
    {"name": "Grace", "position": "HR Manager", "salary": 80000, "age": 34},
    {"name": "Hannah", "position": "Data Scientist", "salary": 97000, "age": 31},
    {"name": "Ian", "position": "Product Manager", "salary": 108000, "age": 36},
    {"name": "Jack", "position": "Software Engineer", "salary": 89000, "age": 27},
    {"name": "Kim", "position": "UX Designer", "salary": 75000, "age": 33},
    {"name": "Laura", "position": "Software Engineer", "salary": 88000, "age": 26},
    {"name": "Mick", "position": "Software Engineer", "salary": 61000, "age": 30},
    {"name": "Nina", "position": "Data Scientist", "salary": 96000, "age": 31},
    {"name": "Oscar", "position": "HR Manager", "salary": 83000, "age": 32},
    {"name": "Paul", "position": "Product Manager", "salary": 102000, "age": 37},
    {"name": "Quinn", "position": "UX Designer", "salary": 76000, "age": 29},
    {"name": "Rachel", "position": "Software Engineer", "salary": 93000, "age": 32},
    {"name": "Steve", "position": "Data Scientist", "salary": 99000, "age": 28},
    {"name": "Tom", "position": "Software Engineer", "salary": 87000, "age": 25},
    {"name": "Uma", "position": "Product Manager", "salary": 110000, "age": 39},
    {"name": "Vera", "position": "HR Manager", "salary": 85000, "age": 30},
    {"name": "Wes", "position": "Software Engineer", "salary": 95000, "age": 33},
    {"name": "Xander", "position": "UX Designer", "salary": 77000, "age": 28},
    {"name": "Yvonne", "position": "Data Scientist", "salary": 98000, "age": 32},
    {"name": "Zane", "position": "Product Manager", "salary": 106000, "age": 40},
    {"name": "Alice", "position": "Software Engineer", "salary": 90000, "age": 29},
    {"name": "Bob", "position": "Data Scientist", "salary": 96000, "age": 30},
    {"name": "Catherine", "position": "HR Manager", "salary": 82000, "age": 31},
    {"name": "Dylan", "position": "Product Manager", "salary": 104000, "age": 34},
    {"name": "Eleanor", "position": "UX Designer", "salary": 74000, "age": 30},
    {"name": "Franklin", "position": "Software Engineer", "salary": 95000, "age": 35},
    {"name": "Gabriel", "position": "Software Engineer", "salary": 93000, "age": 32},
    {"name": "Helen", "position": "Data Scientist", "salary": 98000, "age": 29},
    {"name": "Igor", "position": "Product Manager", "salary": 100000, "age": 38},
    {"name": "Jenny", "position": "UX Designer", "salary": 79000, "age": 29},
    {"name": "Karl", "position": "Software Engineer", "salary": 92000, "age": 28},
    {"name": "Lena", "position": "Software Engineer", "salary": 90000, "age": 33},
    {"name": "Mike", "position": "Data Scientist", "salary": 100000, "age": 31},
    {"name": "Nora", "position": "HR Manager", "salary": 86000, "age": 32},
    {"name": "Oliver", "position": "Product Manager", "salary": 107000, "age": 36},
    {"name": "Paula", "position": "UX Designer", "salary": 76000, "age": 27},
    {"name": "Quincy", "position": "Software Engineer", "salary": 94000, "age": 28},
    {"name": "Riley", "position": "Data Scientist", "salary": 99000, "age": 30},
    {"name": "Sophie", "position": "Software Engineer", "salary": 91000, "age": 29},
    {"name": "Tom", "position": "HR Manager", "salary": 82000, "age": 33},
    {"name": "Ursula", "position": "Product Manager", "salary": 105000, "age": 32},
    {"name": "Victor", "position": "UX Designer", "salary": 78000, "age": 28},
    {"name": "Wendy", "position": "Software Engineer", "salary": 97000, "age": 30},
    {"name": "Xena", "position": "Software Engineer", "salary": 93000, "age": 29}
]

student = [
    {"name": "James", "class": "FC01", "exam score": 75, "nationality": "British"},
    {"name": "Natasha", "class": "FC02", "exam score": 95, "nationality": "Russian"},
    {"name": "Kumail", "class": "FC02", "exam score": 85, "nationality": "Pakistani"},
    {"name": "Tariq", "class": "FC01", "exam score": 75, "nationality": "Egyptian"},
    {"name": "Qimeng", "class": "FC01", "exam score": 80, "nationality": "Chinese"},
    {"name": "Ming", "class": "FC02", "exam score": 90, "nationality": "Chinese"},
    {"name": "Alice", "class": "FC03", "exam score": 88, "nationality": "American"},
    {"name": "Bob", "class": "FC03", "exam score": 78, "nationality": "Canadian"},
    {"name": "Carlos", "class": "FC03", "exam score": 91, "nationality": "Mexican"},
    {"name": "David", "class": "FC04", "exam score": 77, "nationality": "Australian"},
    {"name": "Eva", "class": "FC04", "exam score": 84, "nationality": "German"},
    {"name": "Fiona", "class": "FC04", "exam score": 92, "nationality": "Scottish"},
    {"name": "George", "class": "FC04", "exam score": 70, "nationality": "Irish"},
    {"name": "Helen", "class": "FC05", "exam score": 88, "nationality": "Dutch"},
    {"name": "Igor", "class": "FC05", "exam score": 91, "nationality": "Ukrainian"},
    {"name": "Jack", "class": "FC05", "exam score": 75, "nationality": "American"},
    {"name": "Katherine", "class": "FC06", "exam score": 86, "nationality": "British"},
    {"name": "Liam", "class": "FC06", "exam score": 79, "nationality": "Irish"},
    {"name": "Mia", "class": "FC06", "exam score": 90, "nationality": "Italian"},
    {"name": "Nina", "class": "FC07", "exam score": 85, "nationality": "French"},
    {"name": "Oscar", "class": "FC07", "exam score": 78, "nationality": "Brazilian"},
    {"name": "Oscar", "class": "FC07", "exam score": 83, "nationality": "Spanish"},
    {"name": "Quinn", "class": "FC08", "exam score": 87, "nationality": "Canadian"},
    {"name": "Rita", "class": "FC08", "exam score": 92, "nationality": "Portuguese"},
    {"name": "Sam", "class": "FC08", "exam score": 79, "nationality": "Indian"},
    {"name": "Tom", "class": "FC09", "exam score": 75, "nationality": "British"},
    {"name": "Ursula", "class": "FC09", "exam score": 80, "nationality": "Swiss"},
    {"name": "Vicky", "class": "FC09", "exam score": 88, "nationality": "American"},
    {"name": "William", "class": "FC10", "exam score": 82, "nationality": "Australian"},
    {"name": "Xander", "class": "FC10", "exam score": 90, "nationality": "Dutch"},
    {"name": "Yara", "class": "FC10", "exam score": 84, "nationality": "Brazilian"},
    {"name": "Zoe", "class": "FC11", "exam score": 91, "nationality": "Greek"},
    {"name": "Alex", "class": "FC11", "exam score": 80, "nationality": "Mexican"},
    {"name": "Brian", "class": "FC11", "exam score": 86, "nationality": "German"},
    {"name": "Chloe", "class": "FC12", "exam score": 89, "nationality": "French"},
    {"name": "Daniel", "class": "FC12", "exam score": 77, "nationality": "Spanish"},
    {"name": "Ethan", "class": "FC12", "exam score": 95, "nationality": "American"},
    {"name": "Felicity", "class": "FC13", "exam score": 82, "nationality": "Scottish"},
    {"name": "Oscar", "class": "FC13", "exam score": 89, "nationality": "Italian"},
    {"name": "Henry", "class": "FC13", "exam score": 84, "nationality": "Irish"},
    {"name": "Ivy", "class": "FC14", "exam score": 91, "nationality": "Swiss"},
    {"name": "Jackie", "class": "FC14", "exam score": 76, "nationality": "Dutch"},
    {"name": "Kyle", "class": "FC14", "exam score": 87, "nationality": "Portuguese"},
    {"name": "Leo", "class": "FC15", "exam score": 82, "nationality": "Greek"},
    {"name": "Maya", "class": "FC15", "exam score": 88, "nationality": "Russian"},
    {"name": "Nathan", "class": "FC15", "exam score": 95, "nationality": "Canadian"},
    {"name": "Leonardo", "class": "FC15", "exam score": 82, "nationality": "Greek"},
    {"name": "Natasha", "class": "FC15", "exam score": 88, "nationality": "Russian"},
    {"name": "Natan", "class": "FC15", "exam score": 95, "nationality": "Canadian"}
]

def print_data(data):
    if isinstance(data, list):
        for index, item in enumerate(data):
            print(f"Item {index + 1}:")
            for key, value in item.items():
                print(f"  {key}: {value}")
            print("-" * 40)
    elif isinstance(data, dict):
        for group, value in data.items():
            print(f"{group}: {value}")
            print("-" * 40)
    else:
        print("Unsupported data format")

def filter_data(data, key, value=None, comparison=None):
    filtered_results = []
    for item in data:
        if key in item:
            item_value = item[key]
            if comparison is None:
                if isinstance(item_value, (int, float)):
                    comparison = "gt"
                    if value is None:
                        value = 0
                elif isinstance(item_value, str):
                    comparison = "eq"
                    if value is None:
                        value = ""
                elif item_value is None:
                    comparison = "eq"
                    if value is None:
                        value = None
            if comparison == "eq" and item_value == value:
                filtered_results.append(item)
            elif comparison == "lt" and isinstance(item_value, (int, float)) and item_value < value:
                filtered_results.append(item)
            elif comparison == "gt" and isinstance(item_value, (int, float)) and item_value > value:
                filtered_results.append(item)
    return filtered_results


def aggregate_data(data, group_by_key, aggregate_key, calculate_overall_avg=False):
    grouped_data = {}
    for item in data:
        if group_by_key in item and aggregate_key in item:
            group_value = item[group_by_key]
            aggregate_value = item[aggregate_key]
            if group_value not in grouped_data:
                grouped_data[group_value] = []
            grouped_data[group_value].append(aggregate_value)
    aggregated_results = {}
    for group, values in grouped_data.items():
        aggregated_results[group] = sum(values) / len(values)
    if calculate_overall_avg:
        all_values = [value for values in grouped_data.values() for value in values]
        overall_avg = sum(all_values) / len(all_values) if all_values else None
        return overall_avg
    return aggregated_results

def bubble_sort(data, sort_key):
    n = len(data)
    for i in range(n - 1):
        for j in range(n - 1 - i):
            if data[j][sort_key] > data[j + 1][sort_key]:
                data[j], data[j + 1] = data[j + 1], data[j]

# sort_student = bubble_sort(student, "name")
# print_data(student)

# sort_players = bubble_sort(players, "goals")
# print_data(players)

# sort_employees = bubble_sort(employees, "age")
# print_data(employees)

# filtered_employees_salary = filter_data(employees, "position", "UX Designer")
# print("Employees with more than 90000 salary:")
# print_data(filtered_employees_salary)

# filtered_student = filter_data(student, "nationality", "Russian")
# print("Students filter:")
# print_data(filtered_student)

# filtered_players = filter_data(players, "assists", 1, "eq")
# print("Players filter:")
# print_data(filtered_players)


# aggregated_salary_by_position = aggregate_data(employees, "age", "salary",)
# print("Avg salary for position:\n")
# print_data(aggregated_salary_by_position)


# aggregated_goals_by_team = aggregate_data(players, "team", "assists", )
# print("Avg goasl/assists in teams:\n")
# print_data(aggregated_goals_by_team)

# aggregated_score_by_exam = aggregate_data(student, "class", "exam score", )
# print("\nAvg score:")
# print_data(aggregated_score_by_exam)